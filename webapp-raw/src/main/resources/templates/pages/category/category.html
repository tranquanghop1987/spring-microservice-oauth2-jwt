<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
  <head  th:replace="static/head::head">
    <meta charset="utf-8">
  </head>
  <body class="app header-fixed sidebar-fixed aside-menu-fixed sidebar-lg-show">
    <header th:replace="static/layout::header"></header>
    <div class="app-body">
      <div th:replace="static/layout::sidebar"></div>
      <div class="main">
        <ol  th:replace="static/layout::breadcrumb" class="breadcrumb"></ol>
        <div class="container-fluid">
          <div class="animated fadeIn">
            <div class="row">
              <div class="col-md-12">
                <div class="card">
                  <div class="card-header">Quản lý danh mục</div>
                  <div class="card-body">
                  	<button class="btn btn-primary" type="button" data-toggle="modal" data-target="#addModal">Tạo mới danh mục</button>
                  </div>
                  <div th:replace="pages/category/category-add-edit::category-add-modal"></div>
                  <div th:replace="pages/category/category-add-edit::category-edit-modal"></div>
                  <div class="card-body">
                  	<form th:action="@{/category/list}">
                  		<div class="form-group row">
		                  	<div class="col-md-3">
		                  		<h4>Danh sách danh mục</h4>
		                  	</div>
	                  		<div class="col-md-5"></div>
			                    <div class="col-md-3">
			                      <input class="form-control" type="text" th:name="keyword" placeholder="Tìm kiếm theo tên danh mục">
			                    </div>
		                    <div class="col-md-1">
		                    	<button class="btn btn-success" type="submit">Tìm kiếm</button>
		                    </div>
                     	</div>
                     </form>
                  	<table class="table table-responsive-sm table-bordered table-striped table-sm">
                      <thead>
                        <tr>
                          <th>STT</th>
                          <th>Tên danh mục</th>
                          <th>Đường dẫn</th>
                          <th width="10%">Thao tác</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr th:each="categoryItem, index : ${listCategory}">
                          <td th:text="${index.count}"></td>
                          <td th:text="${categoryItem.categoryName}"></td>
                          <td th:text="${categoryItem.url}"></td>
                          <td>
                            <button class="btn btn-sm btn-primary" type="button" th:onclick="javascript:updateCategory([[${categoryItem.categoryId}]])">Sửa</button>
                            <button class="btn btn-sm btn-danger" type="button" th:onclick="javascript:deleteCategory([[${categoryItem.categoryId}]])">Xóa</button>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <footer th:replace="static/layout::footer"></footer>
    <div th:replace="static/script::script"></div>
    <script th:inline="javascript">
    	function updateCategory(categoryId){
    		$('#editModal').modal('show');
    		
    		$.get("/category/" + categoryId, function(data) {
    			$("#categoryId-edit").val(data.categoryId);
    			$("#categoryName-edit").val(data.categoryName);
    			$("#url-edit").val(data.url);
    			$("#description-edit").val(data.description);
    			$("#parentId-edit").val(data.parentId);
   			});
    	}
    
    	function deleteCategory(categoryId){
    		console.log(categoryId);
    		$.post("/category/delete/"+categoryId, function(){
    			window.location.href="/category/list";
    		});
    	}
    </script>
  </body>
</html>
